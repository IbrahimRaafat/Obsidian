{"path":"System Security/Lecture 8- Intrusion-Detection.pdf","text":"Intrusion Detection System Security (CM0625, CM0631) 2024-25 UniversitÃ  Caâ€™ Foscari Venezia Riccardo Focardi www.unive.it/data/persone/5590470 secgroup.dais.unive.it Intrusion: unauthorized act of bypassing the security mechanisms of a system Intrusion detection: analysis of information from a computer or a network to identify possible intrusions Introduction Intrusion detection Introduction Intruders Verizon Data Breach Investigations Report 2019 Introduction Causes and tactics Verizon Data Breach Investigations Report 2019 Introduction Other .... Verizon Data Breach Investigations Report 2019 Classes of intruders Cybercriminals: individuals or members of an organized crime group with a goal of ï¬nancial reward Activists (a.k.a. hacktivists): individuals or groups motivated by social and political causes Examples: Anonymous, LulzSec, WikiLeaks, ... State-sponsored organizations: groups of hackers sponsored by governments to conduct espionage or sabotage activities Others: hackers motivated by technical challenges or by peer esteem and reputation, usually advancing the state-of-the-art in hacking techniques Intruderâ€™s skills Apprentice: has minimal technical skill, primarily uses existing attack toolkits. Also known as â€œscript- kiddieâ€. Comprises the largest number of attackers Journeyman: modiï¬es and extends existing tools, ï¬nds new variants of vulnerabilities â‡’ Harder to detect than â€œkiddiesâ€ Master: high-level technical skills. Can ï¬nd new (0-day) vulnerabilities and develop new attack toolkits. Typically employed by state-level organizations â‡’ Very hard to detect and stop Examples of intrusions (NIST SP 800-61 ) Remote server compromise (e.g., getting root access) Web server defacing Password cracking Leakage of credit card numbers and credentials Accessing sensitive data without authorization Packet sniï¬ƒng on a network Credential theft through phishing Using unattended, logged-in workstation without permission Intruder behaviour (1) Target acquisition and information gathering: attacker identiï¬es and characterizes the target system â— examine corporate website â— use network exploration / scanning tools such as DNS lookup and NMAP â— identify potential vulnerable services â— interact by email Initial access: is the initial access to the target system by the attacker, based on previous phase â— exploit a vulnerability â— guess weak credentials â— install malware by phishing Intruder behaviour (2) Privilege escalation: attacker exploits a local vulnerability to increase privileges â— search for local vulnerabilities â— install sniffers to capture administrator passwords â‡’ exploit local vulnerabilities or administrator passwords to gain elevated privileges Information leakage and system exploit: leak sensitive data and use local data to access other systems â— scan and examine ï¬les â— transfer sensitive data outside â— use guessed or captured passwords to access other target systems Intruder behaviour (3) Maintaining access: enable continued access to the system(s) â— install remote administration tools and rootkits with backdoors â— use admin password to access â— modify or disable intrusion detection systems â‡’ hide presence Covering tracks: remove evidence of attack activity â— use rootkits to hide installed/modiï¬ed ï¬les â— remove logs Intrusion Detection System (IDS) IDS: Hardware or software that analyzes information from a computer or a network to identify possible intrusions Sensors: collect data that might contain evidence of intrusion â— network packets â— logs â— syscall traces Analyzers: receive input from sensors and determine if an intrusion occurred â— guidance on possible actions â— stores data for future analysis User interface: displays results of analysis (possible intrusions) and allows for system conï¬guration Why shall we bother about IDSs? 1. If an intrusion is detected quickly enough, then the intruder can be identiï¬ed and ejected from the system before too much damage is done or too much data are compromised. In case of immediate reaction, damage can be fully prevented 2. An effective IDS acts as a deterrent, reducing the attack attempts 3. Intrusion detection enables the collection of information about intrusion techniques that can be used to strengthen system and network security Detecting intruder behaviour Honest and malicious behaviours differ ... but they also overlap False positives: honest users identiï¬ed as intruders (loose interpretation) â‡’ False alarms False negatives: intruders identiï¬ed as honest users (tight interpretation) â‡’ Missed alarms Figure from Lawrie Brown, William Stallings. Computer Security: Principles and Practice, 4/E, Pearson. False positive paradox Base-rate fallacy: mind tend to ignore base-rate when more speciï¬c rate information is provided Example: breathalyzers with 5% false positive rate (and no false negatives) â— If test on (random) Bob is positive what is the probability that Bob is really drunk? â— Answer: 95% ? â— No! it depends on the base-rate Example: Assume 1/1000 drivers drunk, on average â— 1/1000 gives true positive â— 5% of 999 = 49.95 give false positive â‡’ 1 / (49.95+1) = 1.96% of positive tests is really drunk! (of course without other evidenceâ€¦. like driving zig-zag!) IDS base-rate fallacy Systems with few intrusions (with respect to the false positive rate) present the base-rate fallacy issue Example: â— 1/10000 malicious behaviour â— 5% false positive rate â‡’ 0.2% of positives will be true IDS becomes useless with too many false positives No trivial solution: â‡’ It would be necessary to make detection extremely tight introducing false negatives Analysis approaches Anomaly detection: involves the collection of data relating to the behavior of legitimate users so to create a model of user behaviour â— current observed behavior is analyzed with respect to the legitimate user model â— classiï¬ed as intrusion when difference is over a threshold Signature or heuristic detection: also known as misuse detection, uses â— a set of known malicious data patterns (signatures) â— attack rules (heuristics) â‡’ This approach can only identify known attacks for which it has patterns or rules (no 0-day!) Anomaly-based detection A model of honest user is built from sensor data, collected in a training phase (no intrusion) Approaches: Statistical: statistical proï¬le of observed metrics ğŸ‘ Simple and eï¬ƒcient ğŸ‘ Non-ï¬‚exible (which metrics?) â— Knowledge based: rules that classify legitimate behaviour ğŸ‘ Robust and ï¬‚exible ğŸ‘ Diï¬ƒcult to develop, requires experts Machine learning: classiï¬cation model, automatically built ğŸ‘ Flexible and automated ğŸ‘ Training expensive, accuracy not yet optimal (+ adversarial ML) Signature and Heuristic Detection Signature-based: match known malicious patterns (large enough to minimize false positives) Example: anti-virus ğŸ‘ Fast, widely accepted ğŸ‘ Continuous review of malware and attacks to create the signatures ğŸ‘ Inability to detect new, 0-day attacks Heuristic-based: rules that identify intrusions or suspicious behaviour, often derived by analyzing existing attack tools ğŸ‘ Fast, widely accepted ğŸ‘ Rules are speciï¬c to the machine and operating systems ğŸ‘ If rules are known, attackers can ï¬nd ways to circumvent them IDS classiï¬cation Host-based IDS (HIDS): Monitors the events occurring in a single host, such as process identiï¬ers and the system calls they make Network-based IDS (NIDS): Monitors network traï¬ƒc for particular network segments or devices and analyzes protocols to identify suspicious activity Distributed or hybrid IDS: Combines information from a number of sensors, often both host and network-based, in a central analyzer that is able to better identify and respond to intrusion activity â‡’ sums up the advantages of multiple HIDS and NIDS Host-based IDS (HIDS) HIDS: an IDS running directly on a host to protect its applications â‡’ detects intrusions, logs suspicious events, send alerts â‡’ detects both internal and external intrusions HIDS DB logs, alerts, ... Single host HIDS sensors (1) System call traces: sequence of syscalls invoked by processes Syscall traces provide accurate information about the interaction of processes with the OS Anomaly-based: create models of honest syscall traces Heuristic-based: rules that detect suspicious syscall invocation Log ï¬les: modern systems already log events which can be directly used as sensors for HIDS ğŸ‘ Less overhead than syscall traces ğŸ‘ Less information, lower detection rate ğŸ‘ Might be easier for the intruder to manipulate HIDS sensors (2) File checksums: compare crypto checksum with stored ones. Look for changes to important ï¬les ğŸ‘ Easily detects integrity attacks ğŸ‘ Overhead managing checksums ğŸ‘ Complex to conï¬gure: which ï¬les to monitor to reduce false positive while detecting intrusions? Example: Tripwire Registry access: monitor access to the registry (Windows OS speciï¬c) Files: Signature-based HIDS that look for known signatures such as in anti-virus programs (ï¬le system, attachments, â€¦) Accesses to resources: Heuristic-based HIDS that look for known suspicious access requests Network-based IDS (NIDS) NIDS: an IDS that monitors traï¬ƒc at selected points on a network Inspects network packets directed to (potentially vulnerable) hosts LAN Internet NIDS NIDS sensor deployment (1) On the external perimeter: ğŸ‘ Detects external intrusions ğŸ‘ Detects ï¬rewall misconï¬guration (if after the ï¬rewall, NIDS 1 ) ğŸ‘ Can detect outgoing malicious traï¬ƒc ğŸ‘ Does not detect internal attacks ğŸ‘ High load if before the ï¬rewall (NIDS 2) LAN 1 Internet LAN 2 NIDS 1 NIDS 2 NIDS sensor deployment (2) Before the LANs: ğŸ‘ Detects both internal and external intrusions ğŸ‘ Detects ï¬rewall misconï¬guration ğŸ‘ Can detect outgoing malicious traï¬ƒc ğŸ‘ Can be conï¬gured on speciï¬c resources LAN 1 Internet LAN 2 NIDS 3 NIDS 4 Anomaly-based NIDS detection Denial-of-service (DoS): involve anomalous increased packet traï¬ƒc or increased connection attempts Scanning: A scanning attack occurs when an attacker probes a target network or system by sending different kinds of packets. It can an be detected by atypical ï¬‚ow patterns Worms: show anomalous behaviour on the network: â— propagate quickly and use large amounts of bandwidth â— cause hosts to communicate (that typically do not) â— cause hosts to use ports that they normally do not use â— many worms perform scanning Signature-based NIDS detection Application layer attacks: patterns of attacks targeting application layer protocols Transport layer attacks: unusual packet fragmentation, TCP-speciï¬c attacks such as SYN ï¬‚oods Network layer attacks: spoofed IP addresses and illegal IP header values Unexpected application services: detect if activity on a transport connection is consistent with the expected application protocol Policy violations: Examples include use of inappropriate websites and use of forbidden application protocols","libVersion":"0.3.2","langs":""}