{"path":"Formal Methods/Lectures/lezione7.pdf","text":"FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Chains Sabina Rossi DAIS Universit`a Ca’ Foscari Venezia Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Stochastic Processes Intuition Many physical systems, including computer and communication networks, evolve in time and often dynamic characteristics are important. For example, we may be interested in the length of a queue how long it takes for massages to be transmitted through a network how much rain falls in successive years Stochastic processes provide models for such evolving systems by describing the sequences of states they enter. Formally, a stochastic model is one represented as a stochastic process. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Stochastic Processes Definition A stochastic process is a set of random variables {X (t), t ∈ T } . T is called the parameter space, its values are often referred to as times. Thus (X (t1), X (t2), . . . , X (tn)) has a known distribution for t1, t2, . . . tn ∈ T . Since we consider continuous time models T = R≥0, i.e., it is the set of non-negative real numbers. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Stochastic Processes State Space The state space S of a stochastic process is the set of all possible values that the random variables X (t) can assume. Each of these values is called a state of the process. Any set of instances of {X (t), t ∈ T } can be regarded as a path of a particle moving randomly in the state space S, its position at time t being X (t). These paths are called sample paths or realisations of the stochastic process. We will interpret each X (t) as the state of some system at time t, and, in accordance with this interpretation, we say that the system is in state xi at time t if X (t) = xi . Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Properties of Stochastic Processes We will simply write X (t) to denote the stochastic process {X (t), t ∈ T } with T = R≥0. Stationary stochastic process If for all t1, t2, . . . tn ∈ T and for all t1 + τ, t2 + τ, . . . tn + τ ∈ T (X (t1), X (t2), . . . , X (tn)) has the same distribution as (X (t1 + τ ), X (t2 + τ ), . . . , X (tn + τ )) then the stochastic process X (t) is called stationary. In a stationary stochastic process the joint probability distribution does not change when shifted in time. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Properties of Stochastic Processes Markov process The stochastic process X (t) is a Markov process if for t0 < t1 < . . . < tn < tn+1 the joint distribution of (X (t0), X (t1), . . . , X (tn), X (tn+1)) is such that Pr (X (tn+1) = xn+1 | X (t0) = x0, X (t1) = x1, . . . , X (tn) = xn) = Pr (X (tn+1) = xn+1 | X (tn) = xn) This is also called memoryless property, that is, given the value of X (tn) at some time tn ∈ T , the future path X (tn+1) for tn+1 > tn does not depend on knowledge of the past history X (t) for t < tn, i.e., for t0 < t1 < · · · < tn−1. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Properties of Stochastic Processes Time Homogeneous Stochastic Processes A Markov process X (t) is time homogeneous if Pr (X (t + τ ) = xi | X (t) = xj ) = Pr (X (t′ + τ ) = xi | X (t′) = xj ) The behaviour of the system does not depend on when it is observed. In particular, the transitions between states are independent of the time at which the transitions occur. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Properties of Stochastic Processes Irreducible Stochastic Processes A Markov process is irreducible if all states in its state space S can be reached from all other states, by following the transitions of the process. If we draw a directed graph of the state space with a node for each state and an arc for each event, or transition, then for any pair of nodes there is a path connecting them, i.e., the graph is strongly connected. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Properties of Stochastic Processes Positive recurrent Markov Processes A state in a Markov process, xi , is called persistent or recurrent if the probability that the process will eventually return to xi is 1. Otherwise the state is called transient. In terms of a system, the recurrent states correspond to the behaviour which is repeatedly exhibited by the system whereas transient states correspond to a behaviour which will be no longer exhibited after a certain time. A recurrent state xi is termed positive-recurrent, or ergodic, if the expected number of steps until the process returns to xi is less than infinity. A stochastic process is ergodic if all its states are positive-recurrent. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Assumptions We will consider Continuous Time Markov Processes (CTMC). We assume that any CTMC we deal with is time homogeneous irreducible ergodic Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Transition rate For a given a CTMC X (t), the transition rate from state xi to state xj is defined by: qij = limτ →0 Pr (X (t + τ ) = xj | X (t) = xi ) τ (i ̸= j) The qij are also called the instantaneous transition rates. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Sojourn time In any stochastic process the time spent in a state is called the sojourn time. By the Markov property, the sojourn times are memoryless, i.e., at any time point, the distribution of the time until the next change of state is independent of the time of the previous change of state. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Exit rate and Sojourn time Let S be the state space of a Markov process X (t). The rate of leaving state xi , denoted by qi , is called exit rate, and it is the sum of all the rates of the individual transistions that leave state xi , i.e., qi = ∑ xj ∈S, j̸=i qij The sojourn time in state xi is exponentially distributed with parameter qi and its mean is 1/qi . Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Transition probabilities The transition probability pij is the probability, given that a transition out of state xi occurs, that it is the transition to state xj . By the definition of conditional probability, this is pij = qij /qi . Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Infinitesimal generator matrix Let S be the state space of a Markov process X (t) and |S| = N. The infinitesimal generator matrix Q of X (t) is the N × N matrix where each entry qij is the transition rate of moving from state xi to state xj the diagonal entries qii are the negative row sum for row i, i.e., qii = − ∑ xj ∈S, j̸=i qij Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes State transition diagram For small Markov processes the simplest way to represent the process is often in terms of its state transition diagram. The nodes in a graph correspond to the states of the process. The arcs are labelled by the transition rates between states. Since every transition is assumed to be governed by an exponential distribution, the rate of the transition will be the parameter of the distribution. Irreducibility implies that the state transition diagram must be strongly connected. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Example 1 Consider a mobile phone antenna whose states are represented by the number of frequencies in use. Suppose that there are 6 frequencies, then the state space is {0, 1, 2, 3, 4, 5, 6}. The only possible transition from state 0 is to state 1, caused by a new connection. Similarly, from state 6 the only possible transition is to state 5, caused by a frequency being released. For any other state j, 1 ≤ j ≤ 5 there are two possible transitions, to states j + 1 or j − 1, caused by a new connection or release of an old one, respectively. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Example 1 Assume that calls arrive according to a random variable exponentially distributed with parameter λ, i.e., the rate at which j → j + 1 transistions occur is λ. Assume that the mean duration of a connection is 1/µ, so that the rate at which release transitions occur on each frequency is µ. The state transition diagram for this process is: 0 1 2 3 4 5 6 λ λ µ λ 2µ λ 3µ λ 4µ λ 5µ 6µ Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Example 1 Assume that calls arrive according to a random variable exponentially distributed with parameter λ, i.e., the rate at which j → j + 1 transistions occur is λ. Assume that the mean duration of a connection is 1/µ, so that the rate at which release transitions occur on each frequency is µ. The state transition diagram for this process is: 0 1 2 3 4 5 6 λ λ µ λ 2µ λ 3µ λ 4µ λ 5µ 6µ Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Steady state probability distribution In performance modelling we are often interested in the probability distribution of the random variables X (t) with t ∈ R≥0 over the state space S, as the system settles into a regular pattern of behaviour. This is termed the steady state probability distribution. From this probability distribution we will derive performance measures based on subsets of states where some condition holds. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Existence of a steady state probability distribution For every time-homogeneous, finite, irreducible Markov process with state space S, there exists a steady state probability distribution {πk | xk ∈ S} . This distribution is unique if it exists and it is the limiting or long term probability distribution πk = limt→∞Pr (X (t) = xk | X (0) = x0) . This distribution is reached when the initial state no longer has any influence. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Probability flux In steady state, πi is the proportion of time that the process spends in state xi . Recall qij is the transition rate that the model makes a transition from state xi to state xj . Thus, in an instant of time, the probability that a transition will occur from state xi to state xj is the probability πi that the model was in state xi multiplied by the transition rate qij . This is called the probability flux from state xi to state xj . Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Global balance equations In steady state, the equilibrium is maintained so that for any state the total probability flux out is equal to the total probability flux into the state. πi ∑ xj ∈S, j̸=i qij ︸ ︷︷ ︸ flux out of xi = ∑ xj ∈S, j̸=i πj qji ︸ ︷︷ ︸ flux into xi Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Global balance equations Recall that the diagonal elements of the infinitesimal generator matrix Q are the negative sum of the other elements in the row, i.e., qii = − ∑ xj ∈S, j̸=i qij . We can use this to rearrange the flux balance equation to be: ∑ xj ∈S πj qji = 0. Expressing the unknown values πi as a row vector π, we can write this as a matrix equation: πQ = 0 . Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Normalisation condition The πi are unknowns - they are the values we wish to find. If there are N states in the state space, the global balance equations give us N equations in N unknowns. However this collection of equations is irreducible. Fortunately, since π is a probability distribution we also know that the normalisation condition holds: ∑ xi ∈S πi = 1 . With these n + 1 equations we can use standard linear algebra techniques to solve the equations and find the n unknowns {πi }. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Example 2 Consider a system with multiple CPUs, each with its own private memory, and one common memory which can be accessed only by one processor at a time. The CPUs execute in private memory for a random time before issuing a common memory access request. Assume that this random time is exponentially distributed with parameter λ. The common memory access duration is also assumed to be exponentially distributed, with parameter µ (the average duration of a common memory access is 1/µ). Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Example 2 If the system has only one processor, it has only two states: 1 The processor is executing in its private memory; 2 The processor is accessing common memory. The system behaviour can be modelled by a 2-state Markov process whose state transition diagram and generator matrix are as shown below: 1 2 λ µ Q = ( −λ λ µ −µ ) Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Example 2 If we consider the probability flux in and out of state 1 we obtain: π1λ = π2µ. Similarly, for state 2: π2µ = π1λ. We know from the normalisation condition that: π1 + π2 = 1. Thus the staedy state probability distribution is: π = ( µ µ + λ , λ µ + λ ) . From this we can deduce, for example, that the probability that the processor is executing in private memory is µ/(µ + λ) . Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Solving the global balance equations In general the systems of equations will be too large to solve by hand. Instead we take advantage of linear algebra packages which can solve matrix equations of the form Ax = b where A is an N × N matrix x is a column vector of N unknowns b is a column vector of N values. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Solving the global balance equations First we must resolve two problems: 1 Our global balance equation is expressed in terms of a row vector of unknowns π, πQ = 0. This problem is resolved by transposing the equation, i.e. QT π = 0, where the right hand side is now a column vector of zeros, rather than a row vector. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes 2 We must eliminate the redundancy in the global balance equations and add in the normalisation condition. We replace one of the global balance equations by the normalisation condition. In QT we replace one row (usually the last) by a row of 1’s. We denote the modified matrix QT N . We must also make the corresponding change to the “solution” vector 0, to be a column vector with 1 in the last row, and zeros everywhere else. We denote this vector eN . Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Example 3 Consider the two-processor version of the multiprocessor with processors A and B. We assume that the processors have different timing characteristics, the private memory access of A being governed by an exponential distribution with parameter λA, the common memory access of B being governed by an exponential distribution with parameter µB , etc. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Example 3: state space Now the state space becomes: 1 A and B both executing in their private memories; 2 B executing in private memory, and A accessing common memory; 3 A executing in private memory, and B accessing common memory; 4 A accessing common memory, B waiting for common memory; 5 B accessing common memory, A waiting for common memory; Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Example 3: state space 1 32 4 5 µA λA λB µB λB µA λA µB Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Example 3: generator matrix Q =           −(λA + λB ) λA λB 0 0 µA −(µA + λB ) 0 λB 0 µB 0 −(µB + λA) 0 λA 0 0 µA −µA 0 0 µB 0 0 −µB           Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Example 3: modified generator matrix QT 5 =           −(λA + λB ) µA µB 0 0 λA −(µA + λB ) 0 0 µB λB 0 −(µB + λA) µA 0 0 λB 0 −µA 0 1 1 1 1 1           Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Example 3: steady state probability distribution If we choose the following values for the parameters: λA = 0.05 λB = 0.1 µA = 0.02 µB = 0.05 solving the global balance equations, we obtain: π = (0.0693, 0.0990, 0.1683, 0.4951, 0.1683) Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Deriving Performance Measures Broadly speaking, there are three ways in which performance measures can be derived from the steady state distribution of a Markov process. These different methods can be thought of as corresponding to different types of measure: state-based measures, e.g. utilisation; rate-based measures, e.g. throughput; other measures which fall outside the above categories, e.g. response time. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes State-based measures State-based measures correspond to the probability that the model is in a state, or a subset of states, which satisfy some condition. For example, utilisation will correspond to those states where a resource is in use. If we consider the multiprocessor example, the utilisation of the common memory, Umem, is the total probability that the model is in one of the states in which the common memory is in use: Umem = π2 + π3 + π4 + π5 = 0, 9307 = 93.07% Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes State-based measures Other examples of state-based measures are idle time, or the number of jobs in a system. Some measures such as the number of jobs will involve a weighted sum of steady state probabilities, weighted by the appropriate value (expectation). For example, if we consider jobs waiting for the common memory to be queued in that subsystem, then the average number of jobs in the common memory, Nmem, is: Nmem = (1 × π2) + (1 × π3) + (2 × π4) + (2 × π5) = 1.594 Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Rate-based measures Rate-based measures are those which correspond to the predicted rate at which some event occurs. This will be the product of the rate of the event, and the probability that the event is enabled, i.e. the probability of being in one of the states from which the event can occur. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Example: Rate-based measures In order to calculate the throughput of the common memory, we need the average number of accesses from either processor which it satisfies in unit time. Xmem is thus calculated as: Xmem = (µA × (π2 + π4)) + (µB × (π3 + π5)) = 0.0287 or, since 1/0.0287 ∼ 35, approximately one access every 35 milliseconds. Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION Continuous Time Markov Processes Other measures The other measures are those which are neither rate-based or state-based. For example, the response time of the common memory can be computed by Wmem = Nmem/Xmem = 1.594/0.0287 = 55.54 milliseconds Sabina Rossi FORMAL METHODS FOR SYSTEM VERIFICATION","libVersion":"0.3.2","langs":""}